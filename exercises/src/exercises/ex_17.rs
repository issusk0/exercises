use std::str::from_utf8;


pub fn ex_17(packet: Vec<u8>){
    let version_ihl = packet[0]; //obtenemos el primer byte 0x45
    let ihl = version_ihl & 0x0F; // movemos el byte a la derecha conservando el 0x4 y cambiando el
                                  // 0x5
    let ip_header_len = ihl as usize * 4; //modificamos el byte de ihl para calcular donde empieza
                                          //el tcp
    let tcp  = &packet[ip_header_len..];
    let data_offset = tcp[12] >>4;
    let tcp_header_len = data_offset as usize * 4;

    let http = &tcp[tcp_header_len..];
    


    match from_utf8(http){
        Ok(text) =>{
            println!("HTTP: {}", text)
        },
        Err(_) => {
            println!("Unexpected error")

        }


    }


}






pub fn data() ->Vec<u8>{
    let packet: Vec<u8> = vec![
    // IPv4
    0x45,0x00,0x00,0x3C,0x1C,0x46,0x40,0x00,0x40,0x06,0xB1,0xE6,
    0xC0,0xA8,0x01,0x02,0xC0,0xA8,0x01,0x01,

    // TCP
    0xC3,0x50,0x00,0x50,0x00,0x00,0x00,0x01,
    0x00,0x00,0x00,0x00,0x50,0x18,0xFF,0xFF,
    0x00,0x00,0x00,0x00,

    // HTTP
    0x47,0x45,0x54,0x20,0x2F,0x20,0x48,0x54,0x54,0x50,0x2F,0x31,0x2E,0x31,0x0D,0x0A,
    0x48,0x6F,0x73,0x74,0x3A,0x20,0x65,0x78,0x61,0x6D,0x70,0x6C,0x65,0x2E,0x63,0x6F,0x6D,0x0D,0x0A,
    0x0D,0x0A,
];

    packet
}
